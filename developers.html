
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>For Developers &#8212; lcdb-wf 0.1 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Module lib.common" href="lib.common.html" />
    <link rel="prev" title="Changelog" href="changelog.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="toc.html">lcdb-wf</a></h1>



<p class="blurb">Customizable workflows for high-throughput sequencing analysis</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Guide to file hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Testing the installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Overview of workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration details</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="rnaseq.html">RNA-seq workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="downstream-rnaseq.html">RNA-Seq downstream analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chipseq.html">ChIP-seq workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrative.html">Integrative workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="faqs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">For Developers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#writing-wrappers">Writing wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-new-aligner">Adding a new aligner</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-new-peak-caller">Adding a new peak-caller</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="toc.html">Documentation overview</a><ul>
      <li>Previous: <a href="changelog.html" title="previous chapter">Changelog</a></li>
      <li>Next: <a href="lib.common.html" title="next chapter">Module <code class="docutils literal notranslate"><span class="pre">lib.common</span></code></a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="for-developers">
<h1>For Developers<a class="headerlink" href="#for-developers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="writing-wrappers">
<h2>Writing wrappers<a class="headerlink" href="#writing-wrappers" title="Permalink to this headline">¶</a></h2>
<p>See the <a class="reference external" href="https://github.com/lcdb/lcdb-wf/tree/master/wrappers/wrappers/demo">demo wrapper</a> for
a template to use when creating your own wrappers.</p>
<div class="section" id="module-documentation">
<h3>Module documentation<a class="headerlink" href="#module-documentation" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="lib.common.html">Module <code class="docutils literal notranslate"><span class="pre">lib.common</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="lib.common.html#functions-for-handling-configuration">Functions for handling configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="lib.common.html#functions-for-handling-references">Functions for handling references</a></li>
<li class="toctree-l2"><a class="reference internal" href="lib.common.html#module-lib.common">Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lib.chipseq.html">Module <code class="docutils literal notranslate"><span class="pre">lib.chipseq</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="lib.chipseq.html#module-lib.chipseq">Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lib.patterns_targets.html">Module <code class="docutils literal notranslate"><span class="pre">lib.patterns_targets</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="lib.patterns_targets.html#details">Details</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="miscellanous-tips">
<h3>Miscellanous tips<a class="headerlink" href="#miscellanous-tips" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="adding-a-new-aligner">
<h2>Adding a new aligner<a class="headerlink" href="#adding-a-new-aligner" title="Permalink to this headline">¶</a></h2>
<p>In <cite>lib/common.py</cite>, there is a function <cite>references_dict</cite>. Within that is
a <cite>index_extensions</cite> dictionary. You’ll need to add the name of the aligner and
the extension of the index it creates. If it creates multiple index files, just
one should be sufficient. The filename will be automatically created and will
be used as the expected output file which can then be accessed from the
references dict as <cite>references_dict[organism][tag][aligner]</cite> for use in various
rules that need the index as input (that is, any mapping rules).</p>
<ul class="simple">
<li><p>add the aligner to the <cite>include/reference_configs/test.yaml</cite> config file,
“indexes:” section.</p></li>
<li><p>write a rule in <cite>workflows/references/Snakefile</cite> to build the index. Use the
other index-building rules there as a guide.</p></li>
<li><p>Depending on which type of workflow the aligner is appropriate for, add
a rule there. Enclose it in an “if:” clause to only run if the config file
has specified that aligner.</p></li>
<li><p>add the name to the list of supported aligners in <cite>docs/config-yaml.rst</cite>, in
the “Aligner config” section.</p></li>
<li><p>add appropriate memory/time requirements to <cite>clusterconfig.yaml</cite> for that
aligner.</p></li>
</ul>
<ul class="simple">
<li><p>For testing, create a copy of the config for any workflows it is used for,
and change only the aligner.</p></li>
<li><p>Modify <cite>.circleci/config.yml</cite> to include a new block in each of the
variables, jobs, and workflows sections. Use the <cite>rnaseq-star</cite> blocks as
a guide for this. The idea is to only run up through the aligner step in
a parallel task (to save on CI build time).</p></li>
</ul>
</div>
<div class="section" id="adding-a-new-peak-caller">
<span id="new-peak-caller"></span><h2>Adding a new peak-caller<a class="headerlink" href="#adding-a-new-peak-caller" title="Permalink to this headline">¶</a></h2>
<p>First, write a wrapper for the peak-caller. You can use the <code class="docutils literal notranslate"><span class="pre">macs2</span></code>, <code class="docutils literal notranslate"><span class="pre">spp</span></code>,
and <code class="docutils literal notranslate"><span class="pre">sicer</span></code> wrappers as a guide. A wrapper should expect one or more sorted
and indexed BAM files as IP, one or more sorted and indexed BAM files as input.
The wrapper should create at least a sorted BED file of peaks, and can
optionally create other supplemental files as well.</p>
<p>Next, add the peak-caller to the top of <code class="docutils literal notranslate"><span class="pre">lib/patterns_targets.py</span></code> in the
<code class="docutils literal notranslate"><span class="pre">PEAK_CALLERS</span></code> list.</p>
<p>Then write a rule for the peak-caller, again using <code class="docutils literal notranslate"><span class="pre">macs2</span></code>, <code class="docutils literal notranslate"><span class="pre">spp</span></code>, or
<code class="docutils literal notranslate"><span class="pre">sicer</span></code> rules as a guide.</p>
<p>Last, add additional lines in
<code class="docutils literal notranslate"><span class="pre">workflows/chipseq/config/chipseq-patterns.yaml</span></code> for the
<code class="docutils literal notranslate"><span class="pre">patterns_by_peaks</span></code> key.</p>
<p>To test or use, add the new peak-caller to the
<code class="docutils literal notranslate"><span class="pre">workflows/chipseq/config/config.yaml</span></code> file’s <code class="docutils literal notranslate"><span class="pre">peak_calling</span></code> key.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2017, Ryan Dale, Justin Fear.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/developers.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>